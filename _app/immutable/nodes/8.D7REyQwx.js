import{s as q,a as ve,c as _e,b as I,d,f as u,i as S,g as p,n as X,j as $,q as H,l as Z,k as w,r as B,m as J,z as He,D as Q,L as Be,e as ce,B as De,a4 as Me,h as Pe,x as Ve,a1 as ge,t as oe,E as Ae,a2 as Ue}from"../chunks/scheduler.BjPIH0FZ.js";import{S as W,i as Y,t as y,g as le,e as se,b as j,c as F,a as L,m as O,d as z,f as je}from"../chunks/index.CxIW9Pu1.js";import{g as Fe,U as Le}from"../chunks/ui.films.BFqcGv3F.js";import{e as fe,w as Oe}from"../chunks/searchFilm.CKQ20VzS.js";import{a as ze}from"../chunks/entry.aaQkHcsM.js";import{U as Ne}from"../chunks/ui.button.wOTSGOzO.js";import{p as Ke}from"../chunks/stores.CLCwFqj9.js";import{p as G}from"../chunks/index.Df2uGT8m.js";import{A as Re}from"../chunks/arrow.BfNKM5ya.js";function qe(a){let e,l;return{c(){e=ve("svg"),l=ve("path"),this.h()},l(s){e=_e(s,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var t=I(e);l=_e(t,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linecap":!0,"stroke-linejoin":!0}),I(l).forEach(d),t.forEach(d),this.h()},h(){u(l,"d","M6.66696 3.33317H5.46696C4.72022 3.33317 4.34658 3.33317 4.06136 3.4785C3.81048 3.60633 3.60665 3.81015 3.47882 4.06104C3.3335 4.34625 3.3335 4.7199 3.3335 5.46663V10.5333C3.3335 11.28 3.3335 11.6532 3.47882 11.9384C3.60665 12.1893 3.81048 12.3935 4.06136 12.5213C4.3463 12.6665 4.71949 12.6665 5.46477 12.6665H10.5356C11.2808 12.6665 11.6535 12.6665 11.9384 12.5213C12.1893 12.3935 12.3938 12.1891 12.5216 11.9382C12.6668 11.6533 12.6668 11.2805 12.6668 10.5352V9.33317M13.3335 5.99984V2.6665M13.3335 2.6665H10.0002M13.3335 2.6665L8.66683 7.33317"),u(l,"stroke","white"),u(l,"stroke-width","2"),u(l,"stroke-linecap","round"),u(l,"stroke-linejoin","round"),u(e,"width","16"),u(e,"height","16"),u(e,"viewBox","0 0 16 16"),u(e,"fill","none"),u(e,"xmlns","http://www.w3.org/2000/svg")},m(s,t){S(s,e,t),p(e,l)},p:X,i:X,o:X,d(s){s&&d(e)}}}class Te extends W{constructor(e){super(),Y(this,e,null,qe,q,{})}}function Ge(a){let e,l,s,t,r,n,i;return{c(){e=$("label"),l=$("input"),s=H(),t=$("span"),r=Z(a[1]),this.h()},l(o){e=w(o,"LABEL",{class:!0});var h=I(e);l=w(h,"INPUT",{type:!0,id:!0,class:!0}),s=B(h),t=w(h,"SPAN",{class:!0});var v=I(t);r=J(v,a[1]),v.forEach(d),h.forEach(d),this.h()},h(){u(l,"type","checkbox"),u(l,"id",a[0]),l.checked=a[2],u(l,"class","svelte-1lfkvy"),u(t,"class","svelte-1lfkvy"),u(e,"class","checkbox svelte-1lfkvy")},m(o,h){S(o,e,h),p(e,l),p(e,s),p(e,t),p(t,r),n||(i=He(e,"input",a[3]),n=!0)},p(o,[h]){h&1&&u(l,"id",o[0]),h&4&&(l.checked=o[2]),h&2&&Q(r,o[1])},i:X,o:X,d(o){o&&d(e),n=!1,i()}}}function Xe(a,e,l){let{id:s}=e,{label:t=""}=e,{checked:r=!1}=e;function n(i){Be.call(this,a,i)}return a.$$set=i=>{"id"in i&&l(0,s=i.id),"label"in i&&l(1,t=i.label),"checked"in i&&l(2,r=i.checked)},[s,t,r,n]}class Ze extends W{constructor(e){super(),Y(this,e,Xe,Ge,q,{id:0,label:1,checked:2})}}function ke(a,e,l){const s=a.slice();return s[4]=e[l],s}function be(a){let e,l;function s(...t){return a[2](a[4],...t)}return e=new Ze({props:{id:a[4].id,label:a[4].label,checked:a[0]==a[4].id}}),e.$on("input",s),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){a=t;const n={};r&2&&(n.id=a[4].id),r&2&&(n.label=a[4].label),r&3&&(n.checked=a[0]==a[4].id),e.$set(n)},i(t){l||(y(e.$$.fragment,t),l=!0)},o(t){j(e.$$.fragment,t),l=!1},d(t){z(e,t)}}}function Je(a){let e,l,s=fe(a[1]),t=[];for(let n=0;n<s.length;n+=1)t[n]=be(ke(a,s,n));const r=n=>j(t[n],1,1,()=>{t[n]=null});return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=ce()},l(n){for(let i=0;i<t.length;i+=1)t[i].l(n);e=ce()},m(n,i){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(n,i);S(n,e,i),l=!0},p(n,[i]){if(i&3){s=fe(n[1]);let o;for(o=0;o<s.length;o+=1){const h=ke(n,s,o);t[o]?(t[o].p(h,i),y(t[o],1)):(t[o]=be(h),t[o].c(),y(t[o],1),t[o].m(e.parentNode,e))}for(le(),o=s.length;o<t.length;o+=1)r(o);se()}},i(n){if(!l){for(let i=0;i<s.length;i+=1)y(t[i]);l=!0}},o(n){t=t.filter(Boolean);for(let i=0;i<t.length;i+=1)j(t[i]);l=!1},d(n){n&&d(e),De(t,n)}}}function Qe(a,e,l){let{options:s=[]}=e;const t=Me();let{value:r=""}=e;const n=(i,o)=>{l(0,r=o.target.checked?i.id:void 0)};return a.$$set=i=>{"options"in i&&l(1,s=i.options),"value"in i&&l(0,r=i.value)},a.$$.update=()=>{a.$$.dirty&1&&t("change",r)},[r,s,n]}class We extends W{constructor(e){super(),Y(this,e,Qe,Je,q,{options:1,value:0})}}function $e(a,e,l){const s=a.slice();return s[15]=e[l],s}function we(a){let e,l,s,t=a[3],r,n,i,o,h,v,c,f,_=(a[0].description||"Описание не найдено")+"",N,k,b,M,g,V,R="Плееры",x,P,ee,K=Ee(a),A=a[6].score>0&&Ie(a),U=a[1]&&ye(a),T=fe(a[2]),C=[];for(let m=0;m<T.length;m+=1)C[m]=Ce($e(a,T,m));const Se=m=>j(C[m],1,1,()=>{C[m]=null});return{c(){e=$("section"),l=$("div"),s=$("div"),K.c(),r=H(),n=$("aside"),i=$("div"),o=$("a"),h=$("div"),A&&A.c(),c=H(),f=$("p"),N=Z(_),k=H(),b=$("div"),U&&U.c(),M=H(),g=$("div"),V=$("h4"),V.textContent=R,x=H(),P=$("div");for(let m=0;m<C.length;m+=1)C[m].c();this.h()},l(m){e=w(m,"SECTION",{class:!0});var D=I(e);l=w(D,"DIV",{class:!0});var E=I(l);s=w(E,"DIV",{class:!0});var te=I(s);K.l(te),te.forEach(d),r=B(E),n=w(E,"ASIDE",{class:!0});var ae=I(n);i=w(ae,"DIV",{class:!0});var re=I(i);o=w(re,"A",{href:!0,target:!0});var he=I(o);h=w(he,"DIV",{class:!0});var de=I(h);A&&A.l(de),de.forEach(d),he.forEach(d),c=B(re),f=w(re,"P",{class:!0});var me=I(f);N=J(me,_),me.forEach(d),re.forEach(d),k=B(ae),b=w(ae,"DIV",{class:!0});var ne=I(b);U&&U.l(ne),M=B(ne),g=w(ne,"DIV",{class:!0});var ie=I(g);V=w(ie,"H4",{class:!0,"data-svelte-h":!0}),Ve(V)!=="svelte-1y64ufn"&&(V.textContent=R),x=B(ie),P=w(ie,"DIV",{class:!0});var pe=I(P);for(let ue=0;ue<C.length;ue+=1)C[ue].l(pe);pe.forEach(d),ie.forEach(d),ne.forEach(d),ae.forEach(d),E.forEach(d),D.forEach(d),this.h()},h(){u(s,"class","player svelte-gvp5dv"),u(h,"class","rating svelte-gvp5dv"),u(o,"href",v=`https://www.kinopoisk.ru/film/${a[5].id}`),u(o,"target","_blank"),u(f,"class","svelte-gvp5dv"),u(i,"class","info svelte-gvp5dv"),u(V,"class","svelte-gvp5dv"),u(P,"class","svelte-gvp5dv"),u(g,"class","sources svelte-gvp5dv"),u(b,"class","actions svelte-gvp5dv"),u(n,"class","svelte-gvp5dv"),u(l,"class","box svelte-gvp5dv"),u(e,"class","svelte-gvp5dv")},m(m,D){S(m,e,D),p(e,l),p(l,s),K.m(s,null),p(l,r),p(l,n),p(n,i),p(i,o),p(o,h),A&&A.m(h,null),p(i,c),p(i,f),p(f,N),p(n,k),p(n,b),U&&U.m(b,null),p(b,M),p(b,g),p(g,V),p(g,x),p(g,P);for(let E=0;E<C.length;E+=1)C[E]&&C[E].m(P,null);ee=!0},p(m,D){if(D&8&&q(t,t=m[3])?(K.d(1),K=Ee(m),K.c(),K.m(s,null)):K.p(m,D),m[6].score>0?A?(A.p(m,D),D&64&&y(A,1)):(A=Ie(m),A.c(),y(A,1),A.m(h,null)):A&&(le(),j(A,1,1,()=>{A=null}),se()),(!ee||D&32&&v!==(v=`https://www.kinopoisk.ru/film/${m[5].id}`))&&u(o,"href",v),(!ee||D&1)&&_!==(_=(m[0].description||"Описание не найдено")+"")&&Q(N,_),m[1]?U?(U.p(m,D),D&2&&y(U,1)):(U=ye(m),U.c(),y(U,1),U.m(b,M)):U&&(le(),j(U,1,1,()=>{U=null}),se()),D&268){T=fe(m[2]);let E;for(E=0;E<T.length;E+=1){const te=$e(m,T,E);C[E]?(C[E].p(te,D),y(C[E],1)):(C[E]=Ce(te),C[E].c(),y(C[E],1),C[E].m(P,null))}for(le(),E=T.length;E<C.length;E+=1)Se(E);se()}},i(m){if(!ee){y(A),y(U);for(let D=0;D<T.length;D+=1)y(C[D]);ee=!0}},o(m){j(A),j(U),C=C.filter(Boolean);for(let D=0;D<C.length;D+=1)j(C[D]);ee=!1},d(m){m&&d(e),K.d(m),A&&A.d(),U&&U.d(),De(C,m)}}}function Ee(a){let e,l;return{c(){e=$("iframe"),this.h()},l(s){e=w(s,"IFRAME",{title:!0,sandbox:!0,src:!0,class:!0}),I(e).forEach(d),this.h()},h(){u(e,"title","player"),e.allowFullscreen="true",u(e,"sandbox","allow-scripts allow-same-origin"),ge(e.src,l=a[3]+a[0].kinopoiskId)||u(e,"src",l),u(e,"class","svelte-gvp5dv")},m(s,t){S(s,e,t)},p(s,t){t&9&&!ge(e.src,l=s[3]+s[0].kinopoiskId)&&u(e,"src",l)},d(s){s&&d(e)}}}function Ie(a){let e,l=a[6].score+"",s,t,r,n=a[6].platform+"",i,o,h,v;return h=new Te({}),{c(){e=$("mark"),s=Z(l),t=H(),r=$("span"),i=Z(n),o=H(),F(h.$$.fragment),this.h()},l(c){e=w(c,"MARK",{class:!0});var f=I(e);s=J(f,l),f.forEach(d),t=B(c),r=w(c,"SPAN",{class:!0});var _=I(r);i=J(_,n),_.forEach(d),o=B(c),L(h.$$.fragment,c),this.h()},h(){u(e,"class","svelte-gvp5dv"),oe(e,"okey",a[6].score>3.9&&a[6].score<7),oe(e,"bad",a[6].score<4),u(r,"class","svelte-gvp5dv")},m(c,f){S(c,e,f),p(e,s),S(c,t,f),S(c,r,f),p(r,i),S(c,o,f),O(h,c,f),v=!0},p(c,f){(!v||f&64)&&l!==(l=c[6].score+"")&&Q(s,l),(!v||f&64)&&oe(e,"okey",c[6].score>3.9&&c[6].score<7),(!v||f&64)&&oe(e,"bad",c[6].score<4),(!v||f&64)&&n!==(n=c[6].platform+"")&&Q(i,n)},i(c){v||(y(h.$$.fragment,c),v=!0)},o(c){j(h.$$.fragment,c),v=!1},d(c){c&&(d(e),d(t),d(r),d(o)),z(h,c)}}}function ye(a){let e,l,s="Добавить в профиль",t,r,n,i,o;function h(c){a[10](c)}let v={options:a[7]};return a[4]!==void 0&&(v.value=a[4]),n=new We({props:v}),Ae.push(()=>je(n,"value",h)),n.$on("change",a[11]),{c(){e=$("div"),l=$("h4"),l.textContent=s,t=H(),r=$("div"),F(n.$$.fragment),this.h()},l(c){e=w(c,"DIV",{class:!0});var f=I(e);l=w(f,"H4",{class:!0,"data-svelte-h":!0}),Ve(l)!=="svelte-1yzpk7b"&&(l.textContent=s),t=B(f),r=w(f,"DIV",{class:!0});var _=I(r);L(n.$$.fragment,_),_.forEach(d),f.forEach(d),this.h()},h(){u(l,"class","svelte-gvp5dv"),u(r,"class","svelte-gvp5dv"),u(e,"class","list svelte-gvp5dv")},m(c,f){S(c,e,f),p(e,l),p(e,t),p(e,r),O(n,r,null),o=!0},p(c,f){const _={};!i&&f&16&&(i=!0,_.value=c[4],Ue(()=>i=!1)),n.$set(_)},i(c){o||(y(n.$$.fragment,c),o=!0)},o(c){j(n.$$.fragment,c),o=!1},d(c){c&&d(e),z(n)}}}function Ye(a){let e=a[15].name+"",l,s;return{c(){l=Z(e),s=H()},l(t){l=J(t,e),s=B(t)},m(t,r){S(t,l,r),S(t,s,r)},p(t,r){r&4&&e!==(e=t[15].name+"")&&Q(l,e)},d(t){t&&(d(l),d(s))}}}function Ce(a){let e,l;function s(){return a[12](a[15])}return e=new Ne({props:{toggle:!0,active:a[3]==a[15].iframe,$$slots:{default:[Ye]},$$scope:{ctx:a}}}),e.$on("click",s),{c(){F(e.$$.fragment)},l(t){L(e.$$.fragment,t)},m(t,r){O(e,t,r),l=!0},p(t,r){a=t;const n={};r&12&&(n.active=a[3]==a[15].iframe),r&262148&&(n.$$scope={dirty:r,ctx:a}),e.$set(n)},i(t){l||(y(e.$$.fragment,t),l=!0)},o(t){j(e.$$.fragment,t),l=!1},d(t){z(e,t)}}}function xe(a){let e,l,s=a[0]!=""&&we(a);return{c(){s&&s.c(),e=ce()},l(t){s&&s.l(t),e=ce()},m(t,r){s&&s.m(t,r),S(t,e,r),l=!0},p(t,[r]){t[0]!=""?s?(s.p(t,r),r&1&&y(s,1)):(s=we(t),s.c(),y(s,1),s.m(e.parentNode,e)):s&&(le(),j(s,1,1,()=>{s=null}),se())},i(t){l||(y(s),l=!0)},o(t){j(s),l=!1},d(t){t&&d(e),s&&s.d(t)}}}function et(a,e,l){let s,t;Pe(a,Ke,g=>l(14,t=g));let{film:r=""}=e,n,i,o=[],h="",v="",c,f=[{id:"planned",label:"Буду смотреть"},{id:"view",label:"Смотрю"}];function _(g){l(3,h=g)}async function N(g,V){!V&&i&&await G.collection("lists").delete(i.id);let R={user:G.authStore.model.id,film_id:g,status:V};i&&V&&await G.collection("lists").update(i.id,R),!i&&V&&await G.collection("lists").create(R),i=await G.collection("lists").getFullList({filter:`film_id = "${c.id}"`}),i=i[0]}ze(async()=>{l(5,c=Object.fromEntries(t.url.searchParams)),l(0,r=await Fe(c.id)),Oe.add(r),l(2,o=[{name:"Alloha",iframe:"https://attractive-as.allarknow.online/?token=a3fd119d8a9418f6c3f6a7ae628a41&kp="},{name:"Collaps",iframe:"https://api.tobaco.ws/embed/kp/"},{name:"VideoCDN",iframe:"https://49442664434375553.svetacdn.in/sZfbdItt5jeX?kp_id="}]),l(3,h=o[0].iframe);let g=await fetch("https://kinobox.tv/api/players?kinopoisk="+c.id).then(V=>V.json());g=g.filter(V=>{if(V.source=="Kodik"&&V.iframeUrl)return!0})[0],g!=null&&g.source&&l(2,o=[...o,{name:g.source,iframe:g.iframeUrl}]);try{l(1,n=G.authStore.isValid),n&&(i=await G.collection("lists").getFullList({filter:`film_id = "${c.id}"`}),i=i[0],l(4,v=i==null?void 0:i.status))}catch{}});function k(g){v=g,l(4,v)}const b=()=>N(c.id,v),M=g=>_(g.iframe);return a.$$set=g=>{"film"in g&&l(0,r=g.film)},a.$$.update=()=>{a.$$.dirty&1&&l(6,s={score:(r==null?void 0:r.ratingKinopoisk)||(r==null?void 0:r.ratingImdb),platform:r!=null&&r.ratingKinopoisk?"Кинопоиск":r!=null&&r.ratingImdb?"IMDB":""})},[r,n,o,h,v,c,s,f,_,N,k,b,M]}class tt extends W{constructor(e){super(),Y(this,e,et,xe,q,{film:0})}}function lt(a){let e,l;return e=new Re({props:{left:!0}}),{c(){F(e.$$.fragment)},l(s){L(e.$$.fragment,s)},m(s,t){O(e,s,t),l=!0},p:X,i(s){l||(y(e.$$.fragment,s),l=!0)},o(s){j(e.$$.fragment,s),l=!1},d(s){z(e,s)}}}function st(a){let e,l,s,t,r,n=(a[0]??"")+"",i,o,h=(a[1]??"")+"",v,c;return s=new Ne({props:{title:"Назад",nav:!0,vibro:!0,dark:!0,circle:!0,$$slots:{default:[lt]},$$scope:{ctx:a}}}),s.$on("click",a[2]),{c(){e=$("section"),l=$("div"),F(s.$$.fragment),t=H(),r=$("h2"),i=Z(n),o=$("span"),v=Z(h),this.h()},l(f){e=w(f,"SECTION",{class:!0});var _=I(e);l=w(_,"DIV",{class:!0});var N=I(l);L(s.$$.fragment,N),N.forEach(d),t=B(_),r=w(_,"H2",{class:!0});var k=I(r);i=J(k,n),o=w(k,"SPAN",{class:!0});var b=I(o);v=J(b,h),b.forEach(d),k.forEach(d),_.forEach(d),this.h()},h(){u(l,"class","back svelte-4j2yli"),u(o,"class","svelte-4j2yli"),u(r,"class","svelte-4j2yli"),u(e,"class","svelte-4j2yli")},m(f,_){S(f,e,_),p(e,l),O(s,l,null),p(e,t),p(e,r),p(r,i),p(r,o),p(o,v),c=!0},p(f,[_]){const N={};_&8&&(N.$$scope={dirty:_,ctx:f}),s.$set(N),(!c||_&1)&&n!==(n=(f[0]??"")+"")&&Q(i,n),(!c||_&2)&&h!==(h=(f[1]??"")+"")&&Q(v,h)},i(f){c||(y(s.$$.fragment,f),c=!0)},o(f){j(s.$$.fragment,f),c=!1},d(f){f&&d(e),z(s)}}}function at(a,e,l){let{title:s=""}=e,{year:t=""}=e;const r=()=>history.go(-2);return a.$$set=n=>{"title"in n&&l(0,s=n.title),"year"in n&&l(1,t=n.year)},[s,t,r]}class rt extends W{constructor(e){super(),Y(this,e,at,st,q,{title:0,year:1})}}function nt(a){var c,f,_,N;let e,l,s,t,r,n,i,o;l=new rt({props:{title:((c=a[0])==null?void 0:c.nameRu)||((f=a[0])==null?void 0:f.nameEn)||((_=a[0])==null?void 0:_.nameOriginal),year:(N=a[0])==null?void 0:N.year}});function h(k){a[1](k)}let v={};return a[0]!==void 0&&(v.film=a[0]),t=new tt({props:v}),Ae.push(()=>je(t,"film",h)),i=new Le({props:{type:"recomends"}}),{c(){e=$("div"),F(l.$$.fragment),s=H(),F(t.$$.fragment),n=H(),F(i.$$.fragment),this.h()},l(k){e=w(k,"DIV",{class:!0});var b=I(e);L(l.$$.fragment,b),s=B(b),L(t.$$.fragment,b),n=B(b),L(i.$$.fragment,b),b.forEach(d),this.h()},h(){u(e,"class","page-watch svelte-3zznia")},m(k,b){S(k,e,b),O(l,e,null),p(e,s),O(t,e,null),p(e,n),O(i,e,null),o=!0},p(k,[b]){var V,R,x,P;const M={};b&1&&(M.title=((V=k[0])==null?void 0:V.nameRu)||((R=k[0])==null?void 0:R.nameEn)||((x=k[0])==null?void 0:x.nameOriginal)),b&1&&(M.year=(P=k[0])==null?void 0:P.year),l.$set(M);const g={};!r&&b&1&&(r=!0,g.film=k[0],Ue(()=>r=!1)),t.$set(g)},i(k){o||(y(l.$$.fragment,k),y(t.$$.fragment,k),y(i.$$.fragment,k),o=!0)},o(k){j(l.$$.fragment,k),j(t.$$.fragment,k),j(i.$$.fragment,k),o=!1},d(k){k&&d(e),z(l),z(t),z(i)}}}function it(a,e,l){let s;function t(r){s=r,l(0,s)}return[s,t]}class ot extends W{constructor(e){super(),Y(this,e,it,nt,q,{})}}function ct(a){let e,l;return e=new ot({}),{c(){F(e.$$.fragment)},l(s){L(e.$$.fragment,s)},m(s,t){O(e,s,t),l=!0},p:X,i(s){l||(y(e.$$.fragment,s),l=!0)},o(s){j(e.$$.fragment,s),l=!1},d(s){z(e,s)}}}class kt extends W{constructor(e){super(),Y(this,e,null,ct,q,{})}}export{kt as component};
