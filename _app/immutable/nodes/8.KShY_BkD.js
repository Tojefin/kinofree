import{s as J,j as y,q as L,l as G,k as E,b as D,r as B,m as M,d as h,f as b,i as F,g as d,z as Se,D as Z,n as se,L as Ue,e as ne,B as ye,a3 as Ne,h as Pe,x as Ee,a1 as de,t as re,E as Ie,a2 as De}from"../chunks/scheduler.YlLT_MhZ.js";import{S as Q,i as W,t as V,g as ae,e as ie,b as S,c as z,a as K,m as R,d as T,f as Ve}from"../chunks/index.K3M16RrR.js";import{g as je,U as Le}from"../chunks/ui.films.HfQz2iL4.js";import{e as oe,w as Be}from"../chunks/searchFilm.az4ILZEi.js";import{a as Fe}from"../chunks/entry.-tmVF6KW.js";import{U as Ce}from"../chunks/ui.button._2l3wbZu.js";import{p as He}from"../chunks/stores.ZSFmh8_K.js";import{p as X}from"../chunks/index.3YLQEot0.js";import{A as Oe}from"../chunks/arrow.f9q8NU4h.js";function ze(s){let e,l,r,t,a,n,i;return{c(){e=y("label"),l=y("input"),r=L(),t=y("span"),a=G(s[1]),this.h()},l(o){e=E(o,"LABEL",{class:!0});var c=D(e);l=E(c,"INPUT",{type:!0,id:!0,class:!0}),r=B(c),t=E(c,"SPAN",{class:!0});var _=D(t);a=M(_,s[1]),_.forEach(h),c.forEach(h),this.h()},h(){b(l,"type","checkbox"),b(l,"id",s[0]),l.checked=s[2],b(l,"class","svelte-1lfkvy"),b(t,"class","svelte-1lfkvy"),b(e,"class","checkbox svelte-1lfkvy")},m(o,c){F(o,e,c),d(e,l),d(e,r),d(e,t),d(t,a),n||(i=Se(e,"input",s[3]),n=!0)},p(o,[c]){c&1&&b(l,"id",o[0]),c&4&&(l.checked=o[2]),c&2&&Z(a,o[1])},i:se,o:se,d(o){o&&h(e),n=!1,i()}}}function Ke(s,e,l){let{id:r}=e,{label:t=""}=e,{checked:a=!1}=e;function n(i){Ue.call(this,s,i)}return s.$$set=i=>{"id"in i&&l(0,r=i.id),"label"in i&&l(1,t=i.label),"checked"in i&&l(2,a=i.checked)},[r,t,a,n]}class Re extends Q{constructor(e){super(),W(this,e,Ke,ze,J,{id:0,label:1,checked:2})}}function he(s,e,l){const r=s.slice();return r[4]=e[l],r}function _e(s){let e,l;function r(...t){return s[2](s[4],...t)}return e=new Re({props:{id:s[4].id,label:s[4].label,checked:s[0]==s[4].id}}),e.$on("input",r),{c(){z(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,a){R(e,t,a),l=!0},p(t,a){s=t;const n={};a&2&&(n.id=s[4].id),a&2&&(n.label=s[4].label),a&3&&(n.checked=s[0]==s[4].id),e.$set(n)},i(t){l||(V(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){T(e,t)}}}function Te(s){let e,l,r=oe(s[1]),t=[];for(let n=0;n<r.length;n+=1)t[n]=_e(he(s,r,n));const a=n=>S(t[n],1,1,()=>{t[n]=null});return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=ne()},l(n){for(let i=0;i<t.length;i+=1)t[i].l(n);e=ne()},m(n,i){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(n,i);F(n,e,i),l=!0},p(n,[i]){if(i&3){r=oe(n[1]);let o;for(o=0;o<r.length;o+=1){const c=he(n,r,o);t[o]?(t[o].p(c,i),V(t[o],1)):(t[o]=_e(c),t[o].c(),V(t[o],1),t[o].m(e.parentNode,e))}for(ae(),o=r.length;o<t.length;o+=1)a(o);ie()}},i(n){if(!l){for(let i=0;i<r.length;i+=1)V(t[i]);l=!0}},o(n){t=t.filter(Boolean);for(let i=0;i<t.length;i+=1)S(t[i]);l=!1},d(n){n&&h(e),ye(t,n)}}}function qe(s,e,l){let{options:r=[]}=e;var t=Ne();let{value:a=""}=e;const n=(i,o)=>{l(0,a=o.target.checked?i.id:void 0)};return s.$$set=i=>{"options"in i&&l(1,r=i.options),"value"in i&&l(0,a=i.value)},s.$$.update=()=>{s.$$.dirty&1&&t("change",a)},[a,r,n]}class Ge extends Q{constructor(e){super(),W(this,e,qe,Te,J,{options:1,value:0})}}function pe(s,e,l){const r=s.slice();return r[20]=e[l],r}function ve(s){let e,l,r,t,a,n,i,o,c,_,f,m=(s[0].description||"Описание не найдено")+"",$,A,u,I,U,N,O="Плееры",q,j,H,p=s[6].score>0&&ge(s),v=s[1]&&be(s),P=oe(s[2]),k=[];for(let g=0;g<P.length;g+=1)k[g]=ke(pe(s,P,g));const Ae=g=>S(k[g],1,1,()=>{k[g]=null});return{c(){e=y("section"),l=y("div"),r=y("div"),t=y("iframe"),n=L(),i=y("aside"),o=y("div"),c=y("div"),p&&p.c(),_=L(),f=y("p"),$=G(m),A=L(),u=y("div"),v&&v.c(),I=L(),U=y("div"),N=y("h4"),N.textContent=O,q=L(),j=y("div");for(let g=0;g<k.length;g+=1)k[g].c();this.h()},l(g){e=E(g,"SECTION",{class:!0});var C=D(e);l=E(C,"DIV",{class:!0});var w=D(l);r=E(w,"DIV",{class:!0});var Y=D(r);t=E(Y,"IFRAME",{title:!0,sandbox:!0,src:!0,class:!0}),D(t).forEach(h),Y.forEach(h),n=B(w),i=E(w,"ASIDE",{class:!0});var x=D(i);o=E(x,"DIV",{class:!0});var ee=D(o);c=E(ee,"DIV",{});var fe=D(c);p&&p.l(fe),fe.forEach(h),_=B(ee),f=E(ee,"P",{class:!0});var ue=D(f);$=M(ue,m),ue.forEach(h),ee.forEach(h),A=B(x),u=E(x,"DIV",{class:!0});var te=D(u);v&&v.l(te),I=B(te),U=E(te,"DIV",{class:!0});var le=D(U);N=E(le,"H4",{class:!0,"data-svelte-h":!0}),Ee(N)!=="svelte-1y64ufn"&&(N.textContent=O),q=B(le),j=E(le,"DIV",{class:!0});var me=D(j);for(let ce=0;ce<k.length;ce+=1)k[ce].l(me);me.forEach(h),le.forEach(h),te.forEach(h),x.forEach(h),w.forEach(h),C.forEach(h),this.h()},h(){b(t,"title","player"),t.allowFullscreen="true",b(t,"sandbox","allow-scripts allow-same-origin"),de(t.src,a=""+(s[3]+s[0].kinopoiskId))||b(t,"src",a),b(t,"class","svelte-1weu1et"),b(r,"class","player svelte-1weu1et"),b(f,"class","svelte-1weu1et"),b(o,"class","info svelte-1weu1et"),b(N,"class","svelte-1weu1et"),b(j,"class","svelte-1weu1et"),b(U,"class","sources svelte-1weu1et"),b(u,"class","actions svelte-1weu1et"),b(i,"class","svelte-1weu1et"),b(l,"class","box svelte-1weu1et"),b(e,"class","svelte-1weu1et")},m(g,C){F(g,e,C),d(e,l),d(l,r),d(r,t),d(l,n),d(l,i),d(i,o),d(o,c),p&&p.m(c,null),d(o,_),d(o,f),d(f,$),d(i,A),d(i,u),v&&v.m(u,null),d(u,I),d(u,U),d(U,N),d(U,q),d(U,j);for(let w=0;w<k.length;w+=1)k[w]&&k[w].m(j,null);H=!0},p(g,C){if((!H||C&9&&!de(t.src,a=""+(g[3]+g[0].kinopoiskId)))&&b(t,"src",a),g[6].score>0?p?p.p(g,C):(p=ge(g),p.c(),p.m(c,null)):p&&(p.d(1),p=null),(!H||C&1)&&m!==(m=(g[0].description||"Описание не найдено")+"")&&Z($,m),g[1]?v?(v.p(g,C),C&2&&V(v,1)):(v=be(g),v.c(),V(v,1),v.m(u,I)):v&&(ae(),S(v,1,1,()=>{v=null}),ie()),C&268){P=oe(g[2]);let w;for(w=0;w<P.length;w+=1){const Y=pe(g,P,w);k[w]?(k[w].p(Y,C),V(k[w],1)):(k[w]=ke(Y),k[w].c(),V(k[w],1),k[w].m(j,null))}for(ae(),w=P.length;w<k.length;w+=1)Ae(w);ie()}},i(g){if(!H){V(v);for(let C=0;C<P.length;C+=1)V(k[C]);H=!0}},o(g){S(v),k=k.filter(Boolean);for(let C=0;C<k.length;C+=1)S(k[C]);H=!1},d(g){g&&h(e),p&&p.d(),v&&v.d(),ye(k,g)}}}function ge(s){let e,l=s[6].platform+"",r,t,a,n,i=s[6].score+"",o;return{c(){e=y("span"),r=G(l),t=G(":"),a=L(),n=y("mark"),o=G(i),this.h()},l(c){e=E(c,"SPAN",{class:!0});var _=D(e);r=M(_,l),t=M(_,":"),_.forEach(h),a=B(c),n=E(c,"MARK",{class:!0});var f=D(n);o=M(f,i),f.forEach(h),this.h()},h(){b(e,"class","svelte-1weu1et"),b(n,"class","svelte-1weu1et"),re(n,"okey",s[6].score>3.9&&s[6].score<7),re(n,"bad",s[6].score<4)},m(c,_){F(c,e,_),d(e,r),d(e,t),F(c,a,_),F(c,n,_),d(n,o)},p(c,_){_&64&&l!==(l=c[6].platform+"")&&Z(r,l),_&64&&i!==(i=c[6].score+"")&&Z(o,i),_&64&&re(n,"okey",c[6].score>3.9&&c[6].score<7),_&64&&re(n,"bad",c[6].score<4)},d(c){c&&(h(e),h(a),h(n))}}}function be(s){let e,l,r="Добавить в профиль",t,a,n,i,o;function c(f){s[14](f)}let _={options:s[7]};return s[4]!==void 0&&(_.value=s[4]),n=new Ge({props:_}),Ie.push(()=>Ve(n,"value",c)),n.$on("change",s[15]),{c(){e=y("div"),l=y("h4"),l.textContent=r,t=L(),a=y("div"),z(n.$$.fragment),this.h()},l(f){e=E(f,"DIV",{class:!0});var m=D(e);l=E(m,"H4",{class:!0,"data-svelte-h":!0}),Ee(l)!=="svelte-1yzpk7b"&&(l.textContent=r),t=B(m),a=E(m,"DIV",{class:!0});var $=D(a);K(n.$$.fragment,$),$.forEach(h),m.forEach(h),this.h()},h(){b(l,"class","svelte-1weu1et"),b(a,"class","svelte-1weu1et"),b(e,"class","list svelte-1weu1et")},m(f,m){F(f,e,m),d(e,l),d(e,t),d(e,a),R(n,a,null),o=!0},p(f,m){const $={};!i&&m&16&&(i=!0,$.value=f[4],De(()=>i=!1)),n.$set($)},i(f){o||(V(n.$$.fragment,f),o=!0)},o(f){S(n.$$.fragment,f),o=!1},d(f){f&&h(e),T(n)}}}function Me(s){let e=s[20].name+"",l,r;return{c(){l=G(e),r=L()},l(t){l=M(t,e),r=B(t)},m(t,a){F(t,l,a),F(t,r,a)},p(t,a){a&4&&e!==(e=t[20].name+"")&&Z(l,e)},d(t){t&&(h(l),h(r))}}}function ke(s){let e,l;function r(){return s[16](s[20])}return e=new Ce({props:{toggle:!0,active:s[3]==s[20].iframe,$$slots:{default:[Me]},$$scope:{ctx:s}}}),e.$on("click",r),{c(){z(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,a){R(e,t,a),l=!0},p(t,a){s=t;const n={};a&12&&(n.active=s[3]==s[20].iframe),a&8388612&&(n.$$scope={dirty:a,ctx:s}),e.$set(n)},i(t){l||(V(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){T(e,t)}}}function Xe(s){let e,l,r=s[0]!=""&&ve(s);return{c(){r&&r.c(),e=ne()},l(t){r&&r.l(t),e=ne()},m(t,a){r&&r.m(t,a),F(t,e,a),l=!0},p(t,[a]){t[0]!=""?r?(r.p(t,a),a&1&&V(r,1)):(r=ve(t),r.c(),V(r,1),r.m(e.parentNode,e)):r&&(ae(),S(r,1,1,()=>{r=null}),ie())},i(t){l||(V(r),l=!0)},o(t){S(r),l=!1},d(t){t&&h(e),r&&r.d(t)}}}function $e(s,e,l,r,t,a,n){try{var i=s[a](n),o=i.value}catch(c){return void l(c)}i.done?e(o):Promise.resolve(o).then(r,t)}function we(s){return function(){var e=this,l=arguments;return new Promise(function(r,t){var a=s.apply(e,l);function n(o){$e(a,r,t,n,i,"next",o)}function i(o){$e(a,r,t,n,i,"throw",o)}n(void 0)})}}function Ze(s,e,l){let r,t;Pe(s,He,p=>l(19,t=p));var a,n,i,o;let{film:c=""}=e;var _,f,m=[],$="",A="",u,I=[{id:"planned",label:"Буду смотреть"},{id:"view",label:"Смотрю"}];function U(p){l(3,$=p)}function N(p,v){return O.apply(this,arguments)}function O(){return O=we(function*(p,v){!v&&f&&(yield X.collection("lists").delete(f.id));var P={user:X.authStore.model.id,film_id:p,status:v};f&&v&&(yield X.collection("lists").update(f.id,P)),!f&&v&&(yield X.collection("lists").create(P)),f=yield X.collection("lists").getFullList({filter:'film_id = "'+u.id+'"'}),f=f[0]}),O.apply(this,arguments)}Fe(we(function*(){var p;l(5,u=Object.fromEntries(t.url.searchParams)),l(0,c=yield je(u.id)),Be.add(c),l(2,m=[{name:"Alloha",iframe:"https://attractive-as.allarknow.online/?token=a3fd119d8a9418f6c3f6a7ae628a41&kp="},{name:"Collaps",iframe:"https://api.tobaco.ws/embed/kp/"},{name:"VideoCDN",iframe:"https://49442664434375553.svetacdn.in/sZfbdItt5jeX?kp_id="}]),l(3,$=m[0].iframe);var v=yield fetch("https://kinobox.tv/api/players?kinopoisk="+u.id).then(k=>k.json());v=v.filter(k=>{if(k.source=="Kodik"&&k.iframeUrl)return!0})[0],(p=v)!=null&&p.source&&l(2,m=[...m,{name:v.source,iframe:v.iframeUrl}]);try{var P;l(1,_=X.authStore.isValid),f=yield X.collection("lists").getFullList({filter:'film_id = "'+u.id+'"'}),f=f[0],l(4,A=(P=f)==null?void 0:P.status)}catch{}}));function q(p){A=p,l(4,A)}const j=()=>N(u.id,A),H=p=>U(p.iframe);return s.$$set=p=>{"film"in p&&l(0,c=p.film)},s.$$.update=()=>{s.$$.dirty&15361&&l(6,r={score:(l(10,a=c)==null?void 0:a.ratingKinopoisk)||(l(11,n=c)==null?void 0:n.ratingImdb),platform:l(12,i=c)!=null&&i.ratingKinopoisk?"Кинопоиск":l(13,o=c)!=null&&o.ratingImdb?"IMDB":""})},[c,_,m,$,A,u,r,I,U,N,a,n,i,o,q,j,H]}class Je extends Q{constructor(e){super(),W(this,e,Ze,Xe,J,{film:0})}}function Qe(s){let e,l;return e=new Oe({props:{left:!0}}),{c(){z(e.$$.fragment)},l(r){K(e.$$.fragment,r)},m(r,t){R(e,r,t),l=!0},p:se,i(r){l||(V(e.$$.fragment,r),l=!0)},o(r){S(e.$$.fragment,r),l=!1},d(r){T(e,r)}}}function We(s){let e,l,r,t,a,n=(s[0]??"")+"",i,o,c=(s[1]??"")+"",_,f;return r=new Ce({props:{title:"Назад",nav:!0,vibro:!0,dark:!0,circle:!0,$$slots:{default:[Qe]},$$scope:{ctx:s}}}),r.$on("click",s[2]),{c(){e=y("section"),l=y("div"),z(r.$$.fragment),t=L(),a=y("h2"),i=G(n),o=y("span"),_=G(c),this.h()},l(m){e=E(m,"SECTION",{class:!0});var $=D(e);l=E($,"DIV",{class:!0});var A=D(l);K(r.$$.fragment,A),A.forEach(h),t=B($),a=E($,"H2",{class:!0});var u=D(a);i=M(u,n),o=E(u,"SPAN",{class:!0});var I=D(o);_=M(I,c),I.forEach(h),u.forEach(h),$.forEach(h),this.h()},h(){b(l,"class","back svelte-4j2yli"),b(o,"class","svelte-4j2yli"),b(a,"class","svelte-4j2yli"),b(e,"class","svelte-4j2yli")},m(m,$){F(m,e,$),d(e,l),R(r,l,null),d(e,t),d(e,a),d(a,i),d(a,o),d(o,_),f=!0},p(m,[$]){const A={};$&8&&(A.$$scope={dirty:$,ctx:m}),r.$set(A),(!f||$&1)&&n!==(n=(m[0]??"")+"")&&Z(i,n),(!f||$&2)&&c!==(c=(m[1]??"")+"")&&Z(_,c)},i(m){f||(V(r.$$.fragment,m),f=!0)},o(m){S(r.$$.fragment,m),f=!1},d(m){m&&h(e),T(r)}}}function Ye(s,e,l){let{title:r=""}=e,{year:t=""}=e;const a=()=>history.back();return s.$$set=n=>{"title"in n&&l(0,r=n.title),"year"in n&&l(1,t=n.year)},[r,t,a]}class xe extends Q{constructor(e){super(),W(this,e,Ye,We,J,{title:0,year:1})}}function et(s){var f,m,$,A;let e,l,r,t,a,n,i,o;l=new xe({props:{title:((f=s[0])==null?void 0:f.nameRu)||((m=s[0])==null?void 0:m.nameEn)||(($=s[0])==null?void 0:$.nameOriginal),year:(A=s[0])==null?void 0:A.year}});function c(u){s[1](u)}let _={};return s[0]!==void 0&&(_.film=s[0]),t=new Je({props:_}),Ie.push(()=>Ve(t,"film",c)),i=new Le({props:{type:"recomends"}}),{c(){e=y("div"),z(l.$$.fragment),r=L(),z(t.$$.fragment),n=L(),z(i.$$.fragment),this.h()},l(u){e=E(u,"DIV",{class:!0});var I=D(e);K(l.$$.fragment,I),r=B(I),K(t.$$.fragment,I),n=B(I),K(i.$$.fragment,I),I.forEach(h),this.h()},h(){b(e,"class","page-watch svelte-3zznia")},m(u,I){F(u,e,I),R(l,e,null),d(e,r),R(t,e,null),d(e,n),R(i,e,null),o=!0},p(u,[I]){var O,q,j,H;const U={};I&1&&(U.title=((O=u[0])==null?void 0:O.nameRu)||((q=u[0])==null?void 0:q.nameEn)||((j=u[0])==null?void 0:j.nameOriginal)),I&1&&(U.year=(H=u[0])==null?void 0:H.year),l.$set(U);const N={};!a&&I&1&&(a=!0,N.film=u[0],De(()=>a=!1)),t.$set(N)},i(u){o||(V(l.$$.fragment,u),V(t.$$.fragment,u),V(i.$$.fragment,u),o=!0)},o(u){S(l.$$.fragment,u),S(t.$$.fragment,u),S(i.$$.fragment,u),o=!1},d(u){u&&h(e),T(l),T(t),T(i)}}}function tt(s,e,l){var r;function t(a){r=a,l(0,r)}return[r,t]}class lt extends Q{constructor(e){super(),W(this,e,tt,et,J,{})}}function rt(s){let e,l;return e=new lt({}),{c(){z(e.$$.fragment)},l(r){K(e.$$.fragment,r)},m(r,t){R(e,r,t),l=!0},p:se,i(r){l||(V(e.$$.fragment,r),l=!0)},o(r){S(e.$$.fragment,r),l=!1},d(r){T(e,r)}}}class dt extends Q{constructor(e){super(),W(this,e,null,rt,J,{})}}export{dt as component};
