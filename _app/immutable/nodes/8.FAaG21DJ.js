import{s as J,j as E,q as L,l as G,k as w,b as D,r as B,m as M,d as m,f as b,i as F,g as h,z as Se,D as Z,n as ne,L as Ue,e as re,B as Ee,a3 as Ne,h as Pe,x as we,a1 as he,t as se,E as Ie,a2 as De}from"../chunks/scheduler.YlLT_MhZ.js";import{S as Q,i as W,t as V,g as ae,e as ie,b as S,c as z,a as K,m as R,d as T,f as Ve}from"../chunks/index.K3M16RrR.js";import{g as je,U as Le}from"../chunks/ui.films.wEEPNvO4.js";import{e as oe,w as Be}from"../chunks/searchFilm.az4ILZEi.js";import{a as Fe}from"../chunks/entry.KLRw59XQ.js";import{U as Ce}from"../chunks/ui.button._2l3wbZu.js";import{p as He}from"../chunks/stores.2rIvJzoM.js";import{p as X}from"../chunks/index.3YLQEot0.js";import{A as Oe}from"../chunks/arrow.f9q8NU4h.js";function ze(n){let e,l,s,t,a,r,i;return{c(){e=E("label"),l=E("input"),s=L(),t=E("span"),a=G(n[1]),this.h()},l(o){e=w(o,"LABEL",{class:!0});var c=D(e);l=w(c,"INPUT",{type:!0,id:!0,class:!0}),s=B(c),t=w(c,"SPAN",{class:!0});var _=D(t);a=M(_,n[1]),_.forEach(m),c.forEach(m),this.h()},h(){b(l,"type","checkbox"),b(l,"id",n[0]),l.checked=n[2],b(l,"class","svelte-1lfkvy"),b(t,"class","svelte-1lfkvy"),b(e,"class","checkbox svelte-1lfkvy")},m(o,c){F(o,e,c),h(e,l),h(e,s),h(e,t),h(t,a),r||(i=Se(e,"input",n[3]),r=!0)},p(o,[c]){c&1&&b(l,"id",o[0]),c&4&&(l.checked=o[2]),c&2&&Z(a,o[1])},i:ne,o:ne,d(o){o&&m(e),r=!1,i()}}}function Ke(n,e,l){let{id:s}=e,{label:t=""}=e,{checked:a=!1}=e;function r(i){Ue.call(this,n,i)}return n.$$set=i=>{"id"in i&&l(0,s=i.id),"label"in i&&l(1,t=i.label),"checked"in i&&l(2,a=i.checked)},[s,t,a,r]}class Re extends Q{constructor(e){super(),W(this,e,Ke,ze,J,{id:0,label:1,checked:2})}}function me(n,e,l){const s=n.slice();return s[4]=e[l],s}function _e(n){let e,l;function s(...t){return n[2](n[4],...t)}return e=new Re({props:{id:n[4].id,label:n[4].label,checked:n[0]==n[4].id}}),e.$on("input",s),{c(){z(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,a){R(e,t,a),l=!0},p(t,a){n=t;const r={};a&2&&(r.id=n[4].id),a&2&&(r.label=n[4].label),a&3&&(r.checked=n[0]==n[4].id),e.$set(r)},i(t){l||(V(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){T(e,t)}}}function Te(n){let e,l,s=oe(n[1]),t=[];for(let r=0;r<s.length;r+=1)t[r]=_e(me(n,s,r));const a=r=>S(t[r],1,1,()=>{t[r]=null});return{c(){for(let r=0;r<t.length;r+=1)t[r].c();e=re()},l(r){for(let i=0;i<t.length;i+=1)t[i].l(r);e=re()},m(r,i){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(r,i);F(r,e,i),l=!0},p(r,[i]){if(i&3){s=oe(r[1]);let o;for(o=0;o<s.length;o+=1){const c=me(r,s,o);t[o]?(t[o].p(c,i),V(t[o],1)):(t[o]=_e(c),t[o].c(),V(t[o],1),t[o].m(e.parentNode,e))}for(ae(),o=s.length;o<t.length;o+=1)a(o);ie()}},i(r){if(!l){for(let i=0;i<s.length;i+=1)V(t[i]);l=!0}},o(r){t=t.filter(Boolean);for(let i=0;i<t.length;i+=1)S(t[i]);l=!1},d(r){r&&m(e),Ee(t,r)}}}function qe(n,e,l){let{options:s=[]}=e;var t=Ne();let{value:a=""}=e;const r=(i,o)=>{l(0,a=o.target.checked?i.id:void 0)};return n.$$set=i=>{"options"in i&&l(1,s=i.options),"value"in i&&l(0,a=i.value)},n.$$.update=()=>{n.$$.dirty&1&&t("change",a)},[a,s,r]}class Ge extends Q{constructor(e){super(),W(this,e,qe,Te,J,{options:1,value:0})}}function pe(n,e,l){const s=n.slice();return s[20]=e[l],s}function ve(n){let e,l,s,t,a,r,i,o,c,_,f,d=(n[0].description||"Описание не найдено")+"",$,A,u,I,U,N,O="Плееры",q,j,H,p=n[6].score>0&&ge(n),v=n[1]&&be(n),P=oe(n[2]),k=[];for(let g=0;g<P.length;g+=1)k[g]=ke(pe(n,P,g));const Ae=g=>S(k[g],1,1,()=>{k[g]=null});return{c(){e=E("section"),l=E("div"),s=E("div"),t=E("iframe"),r=L(),i=E("aside"),o=E("div"),c=E("div"),p&&p.c(),_=L(),f=E("p"),$=G(d),A=L(),u=E("div"),v&&v.c(),I=L(),U=E("div"),N=E("h4"),N.textContent=O,q=L(),j=E("div");for(let g=0;g<k.length;g+=1)k[g].c();this.h()},l(g){e=w(g,"SECTION",{class:!0});var C=D(e);l=w(C,"DIV",{class:!0});var y=D(l);s=w(y,"DIV",{class:!0});var Y=D(s);t=w(Y,"IFRAME",{title:!0,sandbox:!0,src:!0,class:!0}),D(t).forEach(m),Y.forEach(m),r=B(y),i=w(y,"ASIDE",{class:!0});var x=D(i);o=w(x,"DIV",{class:!0});var ee=D(o);c=w(ee,"DIV",{});var fe=D(c);p&&p.l(fe),fe.forEach(m),_=B(ee),f=w(ee,"P",{class:!0});var ue=D(f);$=M(ue,d),ue.forEach(m),ee.forEach(m),A=B(x),u=w(x,"DIV",{class:!0});var te=D(u);v&&v.l(te),I=B(te),U=w(te,"DIV",{class:!0});var le=D(U);N=w(le,"H4",{class:!0,"data-svelte-h":!0}),we(N)!=="svelte-1y64ufn"&&(N.textContent=O),q=B(le),j=w(le,"DIV",{class:!0});var de=D(j);for(let ce=0;ce<k.length;ce+=1)k[ce].l(de);de.forEach(m),le.forEach(m),te.forEach(m),x.forEach(m),y.forEach(m),C.forEach(m),this.h()},h(){b(t,"title","player"),t.allowFullscreen="true",b(t,"sandbox","allow-scripts allow-same-origin"),he(t.src,a=""+(n[3]+n[0].kinopoiskId))||b(t,"src",a),b(t,"class","svelte-nhbuds"),b(s,"class","player svelte-nhbuds"),b(f,"class","svelte-nhbuds"),b(o,"class","info svelte-nhbuds"),b(N,"class","svelte-nhbuds"),b(j,"class","svelte-nhbuds"),b(U,"class","sources svelte-nhbuds"),b(u,"class","actions svelte-nhbuds"),b(i,"class","svelte-nhbuds"),b(l,"class","box svelte-nhbuds"),b(e,"class","svelte-nhbuds")},m(g,C){F(g,e,C),h(e,l),h(l,s),h(s,t),h(l,r),h(l,i),h(i,o),h(o,c),p&&p.m(c,null),h(o,_),h(o,f),h(f,$),h(i,A),h(i,u),v&&v.m(u,null),h(u,I),h(u,U),h(U,N),h(U,q),h(U,j);for(let y=0;y<k.length;y+=1)k[y]&&k[y].m(j,null);H=!0},p(g,C){if((!H||C&9&&!he(t.src,a=""+(g[3]+g[0].kinopoiskId)))&&b(t,"src",a),g[6].score>0?p?p.p(g,C):(p=ge(g),p.c(),p.m(c,null)):p&&(p.d(1),p=null),(!H||C&1)&&d!==(d=(g[0].description||"Описание не найдено")+"")&&Z($,d),g[1]?v?(v.p(g,C),C&2&&V(v,1)):(v=be(g),v.c(),V(v,1),v.m(u,I)):v&&(ae(),S(v,1,1,()=>{v=null}),ie()),C&268){P=oe(g[2]);let y;for(y=0;y<P.length;y+=1){const Y=pe(g,P,y);k[y]?(k[y].p(Y,C),V(k[y],1)):(k[y]=ke(Y),k[y].c(),V(k[y],1),k[y].m(j,null))}for(ae(),y=P.length;y<k.length;y+=1)Ae(y);ie()}},i(g){if(!H){V(v);for(let C=0;C<P.length;C+=1)V(k[C]);H=!0}},o(g){S(v),k=k.filter(Boolean);for(let C=0;C<k.length;C+=1)S(k[C]);H=!1},d(g){g&&m(e),p&&p.d(),v&&v.d(),Ee(k,g)}}}function ge(n){let e,l=n[6].platform+"",s,t,a,r,i=n[6].score+"",o;return{c(){e=E("span"),s=G(l),t=G(":"),a=L(),r=E("mark"),o=G(i),this.h()},l(c){e=w(c,"SPAN",{class:!0});var _=D(e);s=M(_,l),t=M(_,":"),_.forEach(m),a=B(c),r=w(c,"MARK",{class:!0});var f=D(r);o=M(f,i),f.forEach(m),this.h()},h(){b(e,"class","svelte-nhbuds"),b(r,"class","svelte-nhbuds"),se(r,"okey",n[6].score>3.9&&n[6].score<7),se(r,"bad",n[6].score<4)},m(c,_){F(c,e,_),h(e,s),h(e,t),F(c,a,_),F(c,r,_),h(r,o)},p(c,_){_&64&&l!==(l=c[6].platform+"")&&Z(s,l),_&64&&i!==(i=c[6].score+"")&&Z(o,i),_&64&&se(r,"okey",c[6].score>3.9&&c[6].score<7),_&64&&se(r,"bad",c[6].score<4)},d(c){c&&(m(e),m(a),m(r))}}}function be(n){let e,l,s="Добавить в профиль",t,a,r,i,o;function c(f){n[14](f)}let _={options:n[7]};return n[4]!==void 0&&(_.value=n[4]),r=new Ge({props:_}),Ie.push(()=>Ve(r,"value",c)),r.$on("change",n[15]),{c(){e=E("div"),l=E("h4"),l.textContent=s,t=L(),a=E("div"),z(r.$$.fragment),this.h()},l(f){e=w(f,"DIV",{class:!0});var d=D(e);l=w(d,"H4",{class:!0,"data-svelte-h":!0}),we(l)!=="svelte-1yzpk7b"&&(l.textContent=s),t=B(d),a=w(d,"DIV",{class:!0});var $=D(a);K(r.$$.fragment,$),$.forEach(m),d.forEach(m),this.h()},h(){b(l,"class","svelte-nhbuds"),b(a,"class","svelte-nhbuds"),b(e,"class","list svelte-nhbuds")},m(f,d){F(f,e,d),h(e,l),h(e,t),h(e,a),R(r,a,null),o=!0},p(f,d){const $={};!i&&d&16&&(i=!0,$.value=f[4],De(()=>i=!1)),r.$set($)},i(f){o||(V(r.$$.fragment,f),o=!0)},o(f){S(r.$$.fragment,f),o=!1},d(f){f&&m(e),T(r)}}}function Me(n){let e=n[20].name+"",l,s;return{c(){l=G(e),s=L()},l(t){l=M(t,e),s=B(t)},m(t,a){F(t,l,a),F(t,s,a)},p(t,a){a&4&&e!==(e=t[20].name+"")&&Z(l,e)},d(t){t&&(m(l),m(s))}}}function ke(n){let e,l;function s(){return n[16](n[20])}return e=new Ce({props:{toggle:!0,active:n[3]==n[20].iframe,$$slots:{default:[Me]},$$scope:{ctx:n}}}),e.$on("click",s),{c(){z(e.$$.fragment)},l(t){K(e.$$.fragment,t)},m(t,a){R(e,t,a),l=!0},p(t,a){n=t;const r={};a&12&&(r.active=n[3]==n[20].iframe),a&8388612&&(r.$$scope={dirty:a,ctx:n}),e.$set(r)},i(t){l||(V(e.$$.fragment,t),l=!0)},o(t){S(e.$$.fragment,t),l=!1},d(t){T(e,t)}}}function Xe(n){let e,l,s=n[0]!=""&&ve(n);return{c(){s&&s.c(),e=re()},l(t){s&&s.l(t),e=re()},m(t,a){s&&s.m(t,a),F(t,e,a),l=!0},p(t,[a]){t[0]!=""?s?(s.p(t,a),a&1&&V(s,1)):(s=ve(t),s.c(),V(s,1),s.m(e.parentNode,e)):s&&(ae(),S(s,1,1,()=>{s=null}),ie())},i(t){l||(V(s),l=!0)},o(t){S(s),l=!1},d(t){t&&m(e),s&&s.d(t)}}}function $e(n,e,l,s,t,a,r){try{var i=n[a](r),o=i.value}catch(c){return void l(c)}i.done?e(o):Promise.resolve(o).then(s,t)}function ye(n){return function(){var e=this,l=arguments;return new Promise(function(s,t){var a=n.apply(e,l);function r(o){$e(a,s,t,r,i,"next",o)}function i(o){$e(a,s,t,r,i,"throw",o)}r(void 0)})}}function Ze(n,e,l){let s,t;Pe(n,He,p=>l(19,t=p));var a,r,i,o;let{film:c=""}=e;var _,f,d=[],$="",A="",u,I=[{id:"planned",label:"Буду смотреть"},{id:"view",label:"Смотрю"}];function U(p){l(3,$=p)}function N(p,v){return O.apply(this,arguments)}function O(){return O=ye(function*(p,v){!v&&f&&(yield X.collection("lists").delete(f.id));var P={user:X.authStore.model.id,film_id:p,status:v};f&&v&&(yield X.collection("lists").update(f.id,P)),!f&&v&&(yield X.collection("lists").create(P)),f=yield X.collection("lists").getFullList({filter:'film_id = "'+u.id+'"'}),f=f[0]}),O.apply(this,arguments)}Fe(ye(function*(){var p;l(5,u=Object.fromEntries(t.url.searchParams)),l(0,c=yield je(u.id)),Be.add(c),l(2,d=[{name:"Alloha",iframe:"https://attractive-as.allarknow.online/?token=a3fd119d8a9418f6c3f6a7ae628a41&kp="},{name:"Collaps",iframe:"https://api.tobaco.ws/embed/kp/"},{name:"VideoCDN",iframe:"https://49442664434375553.svetacdn.in/sZfbdItt5jeX?kp_id="}]),l(3,$=d[0].iframe);var v=yield fetch("https://kinobox.tv/api/players?kinopoisk="+u.id).then(k=>k.json());v=v.filter(k=>{if(k.source=="Kodik"&&k.iframeUrl)return!0})[0],(p=v)!=null&&p.source&&l(2,d=[...d,{name:v.source,iframe:v.iframeUrl}]);try{var P;l(1,_=X.authStore.isValid),f=yield X.collection("lists").getFullList({filter:'film_id = "'+u.id+'"'}),f=f[0],l(4,A=(P=f)==null?void 0:P.status)}catch{}}));function q(p){A=p,l(4,A)}const j=()=>N(u.id,A),H=p=>U(p.iframe);return n.$$set=p=>{"film"in p&&l(0,c=p.film)},n.$$.update=()=>{n.$$.dirty&15361&&l(6,s={score:(l(10,a=c)==null?void 0:a.ratingKinopoisk)||(l(11,r=c)==null?void 0:r.ratingImdb),platform:l(12,i=c)!=null&&i.ratingKinopoisk?"Кинопоиск":l(13,o=c)!=null&&o.ratingImdb?"IMDB":""})},[c,_,d,$,A,u,s,I,U,N,a,r,i,o,q,j,H]}class Je extends Q{constructor(e){super(),W(this,e,Ze,Xe,J,{film:0})}}function Qe(n){let e,l;return e=new Oe({props:{left:!0}}),{c(){z(e.$$.fragment)},l(s){K(e.$$.fragment,s)},m(s,t){R(e,s,t),l=!0},p:ne,i(s){l||(V(e.$$.fragment,s),l=!0)},o(s){S(e.$$.fragment,s),l=!1},d(s){T(e,s)}}}function We(n){let e,l,s,t,a,r=(n[0]??"")+"",i,o,c=(n[1]??"")+"",_,f;return s=new Ce({props:{title:"Назад",nav:!0,vibro:!0,dark:!0,circle:!0,$$slots:{default:[Qe]},$$scope:{ctx:n}}}),s.$on("click",n[2]),{c(){e=E("section"),l=E("div"),z(s.$$.fragment),t=L(),a=E("h2"),i=G(r),o=E("span"),_=G(c),this.h()},l(d){e=w(d,"SECTION",{class:!0});var $=D(e);l=w($,"DIV",{class:!0});var A=D(l);K(s.$$.fragment,A),A.forEach(m),t=B($),a=w($,"H2",{class:!0});var u=D(a);i=M(u,r),o=w(u,"SPAN",{class:!0});var I=D(o);_=M(I,c),I.forEach(m),u.forEach(m),$.forEach(m),this.h()},h(){b(l,"class","back svelte-4j2yli"),b(o,"class","svelte-4j2yli"),b(a,"class","svelte-4j2yli"),b(e,"class","svelte-4j2yli")},m(d,$){F(d,e,$),h(e,l),R(s,l,null),h(e,t),h(e,a),h(a,i),h(a,o),h(o,_),f=!0},p(d,[$]){const A={};$&8&&(A.$$scope={dirty:$,ctx:d}),s.$set(A),(!f||$&1)&&r!==(r=(d[0]??"")+"")&&Z(i,r),(!f||$&2)&&c!==(c=(d[1]??"")+"")&&Z(_,c)},i(d){f||(V(s.$$.fragment,d),f=!0)},o(d){S(s.$$.fragment,d),f=!1},d(d){d&&m(e),T(s)}}}function Ye(n,e,l){let{title:s=""}=e,{year:t=""}=e;const a=()=>history.back();return n.$$set=r=>{"title"in r&&l(0,s=r.title),"year"in r&&l(1,t=r.year)},[s,t,a]}class xe extends Q{constructor(e){super(),W(this,e,Ye,We,J,{title:0,year:1})}}function et(n){var f,d,$,A;let e,l,s,t,a,r,i,o;l=new xe({props:{title:((f=n[0])==null?void 0:f.nameRu)||((d=n[0])==null?void 0:d.nameEn)||(($=n[0])==null?void 0:$.nameOriginal),year:(A=n[0])==null?void 0:A.year}});function c(u){n[1](u)}let _={};return n[0]!==void 0&&(_.film=n[0]),t=new Je({props:_}),Ie.push(()=>Ve(t,"film",c)),i=new Le({props:{type:"recomends"}}),{c(){e=E("div"),z(l.$$.fragment),s=L(),z(t.$$.fragment),r=L(),z(i.$$.fragment),this.h()},l(u){e=w(u,"DIV",{class:!0});var I=D(e);K(l.$$.fragment,I),s=B(I),K(t.$$.fragment,I),r=B(I),K(i.$$.fragment,I),I.forEach(m),this.h()},h(){b(e,"class","page-watch svelte-3zznia")},m(u,I){F(u,e,I),R(l,e,null),h(e,s),R(t,e,null),h(e,r),R(i,e,null),o=!0},p(u,[I]){var O,q,j,H;const U={};I&1&&(U.title=((O=u[0])==null?void 0:O.nameRu)||((q=u[0])==null?void 0:q.nameEn)||((j=u[0])==null?void 0:j.nameOriginal)),I&1&&(U.year=(H=u[0])==null?void 0:H.year),l.$set(U);const N={};!a&&I&1&&(a=!0,N.film=u[0],De(()=>a=!1)),t.$set(N)},i(u){o||(V(l.$$.fragment,u),V(t.$$.fragment,u),V(i.$$.fragment,u),o=!0)},o(u){S(l.$$.fragment,u),S(t.$$.fragment,u),S(i.$$.fragment,u),o=!1},d(u){u&&m(e),T(l),T(t),T(i)}}}function tt(n,e,l){var s;function t(a){s=a,l(0,s)}return[s,t]}class lt extends Q{constructor(e){super(),W(this,e,tt,et,J,{})}}function st(n){let e,l;return e=new lt({}),{c(){z(e.$$.fragment)},l(s){K(e.$$.fragment,s)},m(s,t){R(e,s,t),l=!0},p:ne,i(s){l||(V(e.$$.fragment,s),l=!0)},o(s){S(e.$$.fragment,s),l=!1},d(s){T(e,s)}}}class ht extends Q{constructor(e){super(),W(this,e,null,st,J,{})}}export{ht as component};
