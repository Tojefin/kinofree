const t="offline",n="offline";self.addEventListener("install",e=>{e.waitUntil((async()=>{await(await caches.open(t)).add(new Request(n,{cache:"reload"}))})()),self.skipWaiting()});self.addEventListener("activate",e=>{e.waitUntil((async()=>{"navigationPreload"in self.registration&&await self.registration.navigationPreload.enable()})()),self.clients.claim()});self.addEventListener("fetch",e=>{e.request.mode==="navigate"&&e.respondWith((async()=>{try{const a=await e.preloadResponse;return a||await fetch(e.request)}catch(a){return console.log("Не удалось получить данные; вместо этого возвращаем страницу для автономного режима.",a),await(await caches.open(t)).match(n)}})())});
