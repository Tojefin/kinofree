import{s as x,j as k,q as I,k as y,b as A,d as g,r as V,x as ee,f as d,t as D,i as J,g as _,y as Q,z as E,A as te,h as ne,B as se,l as re,m as le,C as ae,D as oe,E as ie}from"./scheduler.UmdBsXoH.js";import{S as ue,i as fe,c as q,a as L,m as G,t as R,b as z,d as H}from"./index.Vbt9v2Aa.js";import{L as ce,e as W,s as pe}from"./searchFilm.q046qK5L.js";import{a as he,g as X}from"./entry.NUIOFjUy.js";import{p as me}from"./stores.PkC-A_-y.js";import{C as _e}from"./cross.wHwlKTs7.js";import{A as de}from"./arrow.68QDVyr3.js";import{v as ge}from"./ui.button.eDEFvkPg.js";function Y(o,l,e){const s=o.slice();return s[18]=l[e].title,s[19]=l[e].id,s}function Z(o){let l,e=W(o[0].list),s=[];for(let r=0;r<e.length;r+=1)s[r]=j(Y(o,e,r));return{c(){l=k("ul");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){l=y(r,"UL",{class:!0});var n=A(l);for(let t=0;t<s.length;t+=1)s[t].l(n);n.forEach(g),this.h()},h(){d(l,"class","suggest svelte-f9d7u4")},m(r,n){J(r,l,n);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(l,null)},p(r,n){if(n&9){e=W(r[0].list);let t;for(t=0;t<e.length;t+=1){const p=Y(r,e,t);s[t]?s[t].p(p,n):(s[t]=j(p),s[t].c(),s[t].m(l,null))}for(;t<s.length;t+=1)s[t].d(1);s.length=e.length}},d(r){r&&g(l),se(s,r)}}}function j(o){let l,e=o[18]+"",s,r,n,t;function p(){return o[13](o[18])}return{c(){l=k("button"),s=re(e),r=I(),this.h()},l(a){l=y(a,"BUTTON",{class:!0});var u=A(l);s=le(u,e),r=V(u),u.forEach(g),this.h()},h(){d(l,"class","svelte-f9d7u4")},m(a,u){J(a,l,u),_(l,s),_(l,r),n||(t=E(l,"pointerdown",ae(p)),n=!0)},p(a,u){o=a,u&1&&e!==(e=o[18]+"")&&oe(s,e)},d(a){a&&g(l),n=!1,t()}}}function ve(o){let l,e,s,r,n,t,p,a,u,N,T=o[2]&&o[0].list.length&&o[3].trim().length>2,U,m,v,F="Найти",P,b,B,w,O,f;r=new ce({}),u=new _e({props:{small:!0}});let c=T&&Z(o);return b=new de({props:{circle:!0}}),{c(){l=k("div"),e=k("div"),s=k("div"),q(r.$$.fragment),n=I(),t=k("input"),p=I(),a=k("button"),q(u.$$.fragment),N=I(),c&&c.c(),U=I(),m=k("button"),v=k("p"),v.textContent=F,P=I(),q(b.$$.fragment),this.h()},l(i){l=y(i,"DIV",{class:!0});var h=A(l);e=y(h,"DIV",{class:!0});var C=A(e);s=y(C,"DIV",{class:!0});var K=A(s);L(r.$$.fragment,K),K.forEach(g),n=V(C),t=y(C,"INPUT",{type:!0,placeholder:!0,class:!0}),p=V(C),a=y(C,"BUTTON",{class:!0});var M=A(a);L(u.$$.fragment,M),M.forEach(g),N=V(C),c&&c.l(C),C.forEach(g),U=V(h),m=y(h,"BUTTON",{class:!0});var S=A(m);v=y(S,"P",{class:!0,"data-svelte-h":!0}),ee(v)!=="svelte-173t95q"&&(v.textContent=F),P=V(S),L(b.$$.fragment,S),S.forEach(g),h.forEach(g),this.h()},h(){d(s,"class","loupe svelte-f9d7u4"),d(t,"type","text"),d(t,"placeholder","Фильм или сериал"),d(t,"class","svelte-f9d7u4"),d(a,"class","clear svelte-f9d7u4"),D(a,"canClear",o[3]),d(e,"class","input svelte-f9d7u4"),D(e,"inputFocus",o[2]),D(e,"inputValue",o[3].length&&!o[2]),d(v,"class","svelte-f9d7u4"),d(m,"class","search svelte-f9d7u4"),m.disabled=B=!(o[3].trim().length>0),d(l,"class","searchBar svelte-f9d7u4")},m(i,h){J(i,l,h),_(l,e),_(e,s),G(r,s,null),_(e,n),_(e,t),Q(t,o[3]),o[12](t),_(e,p),_(e,a),G(u,a,null),_(e,N),c&&c.m(e,null),_(l,U),_(l,m),_(m,v),_(m,P),G(b,m,null),w=!0,O||(f=[E(t,"focus",o[9]),E(t,"blur",o[10]),E(t,"keydown",o[8]),E(t,"keyup",o[7]),E(t,"input",o[11]),E(a,"click",o[5]),E(m,"pointerdown",o[14])],O=!0)},p(i,[h]){h&8&&t.value!==i[3]&&Q(t,i[3]),(!w||h&8)&&D(a,"canClear",i[3]),h&13&&(T=i[2]&&i[0].list.length&&i[3].trim().length>2),T?c?c.p(i,h):(c=Z(i),c.c(),c.m(e,null)):c&&(c.d(1),c=null),(!w||h&4)&&D(e,"inputFocus",i[2]),(!w||h&12)&&D(e,"inputValue",i[3].length&&!i[2]),(!w||h&8&&B!==(B=!(i[3].trim().length>0)))&&(m.disabled=B)},i(i){w||(R(r.$$.fragment,i),R(u.$$.fragment,i),R(b.$$.fragment,i),w=!0)},o(i){z(r.$$.fragment,i),z(u.$$.fragment,i),z(b.$$.fragment,i),w=!1},d(i){i&&g(l),H(r),o[12](null),H(u),c&&c.d(),H(b),O=!1,te(f)}}}function $(o,l,e,s,r,n,t){try{var p=o[n](t),a=p.value}catch(u){return void e(u)}p.done?l(a):Promise.resolve(a).then(s,r)}function be(o){return function(){var l=this,e=arguments;return new Promise(function(s,r){var n=o.apply(l,e);function t(a){$(n,s,r,t,p,"next",a)}function p(a){$(n,s,r,t,p,"throw",a)}t(void 0)})}}function we(o,l,e){let s;ne(o,me,f=>e(17,s=f));var r,n={select:-1,list:[]},t,p=!1,a="";function u(f){e(2,p=f)}function N(){e(3,a=""),t.focus()}function T(){a.trim()&&X("./search?key="+encodeURIComponent(a))}var U=null;function m(f){f.key=="ArrowUp"||f.key=="ArrowDown"||a.trim().length<3||(U&&clearTimeout(U),e(0,n.select=-1,n),U=setTimeout(be(function*(){var{films:c}=yield pe(a);c?e(0,n.list=c.map(i=>({title:(i.nameRu||i.nameEn)+" "+(i.year||""),id:i.filmId})).slice(0,5),n):e(0,n.list=[],n),e(0,n.list[-1]={title:a},n)}),400))}function v(f){f.key=="Enter"&&T(),f.key=="ArrowUp"&&n.list.length>0&&n.select>-1&&(e(0,n.select--,n),e(3,a=n.list[n.select].title)),f.key=="ArrowDown"&&n.list.length>0&&n.select+1<n.list.length&&(e(0,n.select++,n),e(3,a=n.list[n.select].title))}he(()=>{r=Object.fromEntries(s.url.searchParams),r.key&&e(3,a=r.key)});const F=()=>u(!0),P=()=>u(!1);function b(){a=this.value,e(3,a)}function B(f){ie[f?"unshift":"push"](()=>{t=f,e(1,t)})}return[n,t,p,a,u,N,T,m,v,F,P,b,B,f=>{e(3,a=f),X(`/search?key=${f}`)},()=>{ge(),T()}]}class De extends ue{constructor(l){super(),fe(this,l,we,ve,x,{})}}export{De as U};
