<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<link rel="shortcut icon" href="assets/img/favicon.ico" type="image/x-icon">
	<link rel="stylesheet" href="assets/css/style.css">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;700&display=swap" rel="stylesheet">
	<title>KinoFree</title>
</head>
<body>
<div class="main">
	<div class="container">
		<h1 class="title">KinoFree</h1>
		<text class="subtitle">Смотрите кино бесплатно</text>
		<div class="form" id="yohoho" data-tv="1" data-bg="#242424" data-fast="1">
			<input type="text" placeholder="Название фильма" id="search-title" name="title" class="search">
			<input type="button" value="Поиск" id="search" class="button">
		</div>
		<div id="search-list" class="search-list">

		</div>
	</div>

</div>
<div class="menu">
	<div class="menu_button" style="margin-right: 15%;">
		<a href="./">
			<svg class="u-svg-content" viewBox="0 0 512 512" x="0px" y="0px" id="svg-d182" style="fill: #fff;">
				<path d="M505.749,475.587l-145.6-145.6c28.203-34.837,45.184-79.104,45.184-127.317c0-111.744-90.923-202.667-202.667-202.667    S0,90.925,0,202.669s90.923,202.667,202.667,202.667c48.213,0,92.48-16.981,127.317-45.184l145.6,145.6    c4.16,4.16,9.621,6.251,15.083,6.251s10.923-2.091,15.083-6.251C514.091,497.411,514.091,483.928,505.749,475.587z     M202.667,362.669c-88.235,0-160-71.765-160-160s71.765-160,160-160s160,71.765,160,160S290.901,362.669,202.667,362.669z"/>
			</svg>
		</a>
	</div>
		<div class="menu_button">
			<a href="./">
                <svg class="u-svg-content" viewBox="0 0 512 512" x="0px" y="0px" id="svg-d182" style="fill: #fff;">
                    <path d="M437.1,233.45c14.8-10.4,24.6-27.7,24.6-47.2c0-31.9-25.8-57.7-57.7-57.7c-31.9,0-57.7,25.8-57.7,57.7
                    c0,19.5,9.7,36.8,24.6,47.2c-12.7,4.4-24.3,11.2-34.1,20c-13.5-11.5-29.4-20.3-46.8-25.5c21.1-12.8,35.3-36.1,35.3-62.6
                    c0-40.4-32.7-73.1-73.1-73.1c-40.4,0-73.1,32.8-73.1,73.1c0,26.5,14.1,49.8,35.3,62.6c-17.2,5.2-32.9,13.9-46.3,25.2
                    c-9.8-8.6-21.2-15.3-33.7-19.6c14.8-10.4,24.6-27.7,24.6-47.2c0-31.9-25.8-57.7-57.7-57.7s-57.7,25.8-57.7,57.7
                    c0,19.5,9.7,36.8,24.6,47.2C28.5,247.25,0,284.95,0,329.25v6.6c0,0.2,0.2,0.4,0.4,0.4h122.3c-0.7,5.5-1.1,11.2-1.1,16.9v6.8
                    c0,29.4,23.8,53.2,53.2,53.2h155c29.4,0,53.2-23.8,53.2-53.2v-6.8c0-5.7-0.4-11.4-1.1-16.9H505c0.2,0,0.4-0.2,0.4-0.4v-6.6
                    C505.2,284.85,476.8,247.15,437.1,233.45z M362.3,186.15c0-23,18.7-41.7,41.7-41.7s41.7,18.7,41.7,41.7
                    c0,22.7-18.3,41.2-40.9,41.7c-0.3,0-0.5,0-0.8,0s-0.5,0-0.8,0C380.5,227.45,362.3,208.95,362.3,186.15z M194.9,165.35
                    c0-31.5,25.6-57.1,57.1-57.1s57.1,25.6,57.1,57.1c0,30.4-23.9,55.3-53.8,57c-1.1,0-2.2,0-3.3,0c-1.1,0-2.2,0-3.3,0
                    C218.8,220.65,194.9,195.75,194.9,165.35z M59.3,186.15c0-23,18.7-41.7,41.7-41.7s41.7,18.7,41.7,41.7c0,22.7-18.3,41.2-40.9,41.7
                    c-0.3,0-0.5,0-0.8,0s-0.5,0-0.8,0C77.6,227.45,59.3,208.95,59.3,186.15z M125.5,320.15H16.2c4.5-42.6,40.5-76,84.2-76.3
                    c0.2,0,0.4,0,0.6,0s0.4,0,0.6,0c20.8,0.1,39.8,7.8,54.5,20.3C141.7,279.75,131,298.95,125.5,320.15z M366.8,359.95
                    c0,20.5-16.7,37.2-37.2,37.2h-155c-20.5,0-37.2-16.7-37.2-37.2v-6.8c0-62.1,49.6-112.9,111.3-114.7c1.1,0.1,2.3,0.1,3.4,0.1
                    s2.3,0,3.4-0.1c61.7,1.8,111.3,52.6,111.3,114.7V359.95z M378.7,320.15c-5.5-21.1-16-40-30.3-55.6c14.8-12.8,34-20.5,55-20.7
                    c0.2,0,0.4,0,0.6,0s0.4,0,0.6,0c43.7,0.3,79.7,33.7,84.2,76.3H378.7z"/>
                </svg>
			</a>
		</div>
		<div class="menu_button" style="margin-left: 15%;">
			<a href="./О нас">
				<svg class="u-svg-content" viewBox="0 0 512 512" x="0px" y="0px" id="svg-d182" style="fill: #fff;">
					<path d="M100.5,432h311c33.084,0,60-26.916,60-60V60c0-33.084-26.916-60-60-60h-311c-33.084,0-60,26.916-60,60v392  c0,33.084,26.916,60,60,60h291h20c33.084,0,60-26.916,60-60v-0.05c-16.725,12.583-37.506,20.05-60,20.05h-20h-291  c-11.028,0-20-8.972-20-20S89.472,432,100.5,432z M80.5,60c0-11.028,8.972-20,20-20h311c11.028,0,20,8.972,20,20v312  c0,11.028-8.972,20-20,20h-311c-7.009,0-13.742,1.208-20,3.427V60z M238.411,121c0-13.807,11.193-25,25-25s25,11.193,25,25  s-11.193,25-25,25S238.411,134.807,238.411,121z M212.977,224.815l-17.517-35.961c0.01-0.004,2.822-1.375,16.378-7.989  c16.264-7.937,35.427-6.206,50.01,4.517c14.578,10.721,21.94,28.493,19.212,46.381c-0.096,0.625-0.221,1.247-0.375,1.861  l-15.876,63.147c-0.328,3.996,1.984,6.354,3.448,7.431c1.549,1.138,4.747,2.757,8.771,0.792l13.589-6.63l17.54,35.949l-13.588,6.63  c-6.775,3.306-14.054,4.935-21.294,4.935c-10.142,0-20.208-3.194-28.716-9.451c-14.579-10.722-21.94-28.493-19.211-46.381  c0.096-0.626,0.221-1.247,0.375-1.861l15.876-63.147c0.328-3.996-1.985-6.354-3.449-7.431c-1.548-1.138-4.748-2.756-8.771-0.793  C215.78,223.45,212.977,224.815,212.977,224.815z"/>
				</svg>
			</a>
		</div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//yohoho.cc/yo.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {

        var search = document.querySelector('#search');
        var title = document.querySelector('#search-title');

				if (search) {
            search.addEventListener('click', function () {
							$(".listBlock").remove();
                return kp_parse();
								console.log(title);
            });
        }

        if (title) {
            title.addEventListener('keyup', function (event) {
                event.preventDefault();
                if (event.keyCode === 13) {
									$(".listBlock").remove();
                    return kp_parse();
										console.log(title);
                }
            });
        }

			 	async function kp_parse() {
					let url = ('https://kinopoiskapiunofficial.tech/api/v2.1/films/search-by-keyword?keyword=' + title.value + '&page=1');
					let response = await fetch(url , {
						method: 'GET',
						headers: {
							"Content-Type": "application/json",
							"X-API-KEY": "4b12f46d-638b-4bac-bf06-33865d3a3524",
						},
					});
					if (response.ok) {
					  let data = await response.json();
					  console.log(data);
						$(data.films).each(function(index, item) {
						  $('#search-list').append(
								'<div class="listBlock"><img onclick="parse('+item.filmId+')" src="'+ item.posterUrl +'" width="20%" height="20%"><text class="listName">' + item.nameRu + '</text><text class="listDesc">' + item.description + '</text><text class="listYear">' + item.year + '</text><text class="listRating">' + item.rating + '</text></div>');
						});
					} else {
					  alert('error', response.status);
					}
				}
    });
</script>
<script>
function parse(id) {
		$(".search-list").remove();
		var player = document.querySelector('#yohoho');
		if (id && id && player) {
				if (/kinopoisk\.ru/i.test(id)) {
						var exec = /(film\/|movie\/).*?([0-9]{3,7})\//gi.exec(id);
						if (exec && exec[2]) {
								player.dataset.kinopoisk = exec[2];
								if (window.location.href === '/') {
										window.location.href = '#' + player.dataset.kinopoisk;
										return;
								}
								window.location.hash = '#' + player.dataset.kinopoisk;
								document.title = 'KinoFree | ' + player.dataset.kinopoisk;
						}
				} else if (/^\d+$/.test(id)) {
						player.dataset.kinopoisk = id;
						if (window.location.href === '/') {
								window.location.href = '#' + player.dataset.kinopoisk;
								return;
						}
						window.location.hash = '#' + player.dataset.kinopoisk;
						document.title = 'KinoFree | ' + player.dataset.kinopoisk;
				} else {
						player.dataset.title = encodeURIComponent(id);
						if (window.location.href === '/') {
								window.location.href = '#' + player.dataset.title;
								return;
						}
						window.location.hash = '#' + player.dataset.title;
						document.title = 'KinoFree | ' + id;
				}
				items = [];
				return yo();
		}
}
</script>

</body>
</html>
